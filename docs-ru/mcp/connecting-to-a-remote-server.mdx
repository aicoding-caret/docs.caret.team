---
title: "Подключение к удаленному серверу"
description: "Model Context Protocol (MCP) позволяет Caret взаимодействовать с внешними серверами, которые предоставляют дополнительные инструменты и ресурсы для расширения его возможностей. В этом руководстве объясняется, как добавлять и подключаться к удаленным MCP серверам через интерфейс MCP Servers."
---

## Добавление и управление удаленными MCP серверами

### Доступ к интерфейсу MCP Servers

Чтобы получить доступ к интерфейсу MCP Servers в Caret:

1. Нажмите на значок Caret на боковой панели VS Code
2. Откройте меню (⋮) в правом верхнем углу панели Caret
3. Выберите "MCP Servers" из выпадающего меню

### Описание интерфейса MCP Servers

Интерфейс MCP Servers разделен на три основные вкладки:

-   **Marketplace**: Поиск и установка предварительно настроенных MCP серверов (если включено)
-   **Remote Servers**: Подключение к существующим MCP серверам через URL endpoints
-   **Installed**: Управление подключенными MCP серверами

### Добавление удаленного MCP сервера

Вкладка "Remote Servers" позволяет подключаться к любому MCP серверу, доступному через URL endpoint:

1. Перейдите на вкладку "Remote Servers" в интерфейсе MCP Servers
2. Заполните необходимую информацию:
    - **Server Name**: Укажите уникальное, описательное имя для сервера
    - **Server URL**: Введите полный URL endpoint MCP сервера (например, `https://example.com/mcp-sse`)
    - **Transport Type**: Выберите протокол подключения (Streamable HTTP рекомендуется для современных серверов)
3. Нажмите "Add Server", чтобы инициировать соединение
4. Caret попытается подключиться к серверу и отобразит статус соединения

> **Примечание**: При подключении к удаленному серверу убедитесь, что вы доверяете источнику, так как MCP серверы могут выполнять код в вашей среде.

#### Transport Types

Caret поддерживает два транспортных протокола для удаленных MCP серверов:

-   **Streamable HTTP (Рекомендуется)**: Современный транспортный протокол MCP с улучшенной производительностью, надежностью и полной поддержкой аутентификации OAuth 2.1. Используйте этот протокол для большинства удаленных серверов.
-   **SSE (Устаревший)**: Server-Sent Events транспорт. Используйте этот протокол только в том случае, если сервер требует SSE или не поддерживает Streamable HTTP.

#### OAuth Authentication

Некоторые MCP серверы (например, MCP от Vercel) требуют аутентификацию OAuth для безопасного доступа к вашим данным. При подключении к серверу с поддержкой OAuth:

1. Добавьте сервер как обычно, указав его URL
2. Если сервер требует аутентификацию, вы увидите сообщение об ошибке с просьбой пройти аутентификацию.
3. Нажмите появившуюся кнопку **"Authenticate"**
4. Ваш браузер откроет страницу авторизации сервера
5. Войдите в систему и предоставьте разрешение
6. Вы будете автоматически перенаправлены обратно в Caret
7. Сервер подключится и покажет зеленую точку статуса

После аутентификации ваши учетные данные надежно сохраняются, и сервер будет автоматически переподключаться при перезагрузке Caret. Вам не нужно будет повторно проходить аутентификацию, если вы не удалите сервер или срок действия ваших учетных данных не истечет.

### Remote Server Discovery

Если вы ищете MCP серверы для подключения, несколько сторонних marketplace предоставляют каталоги доступных серверов с различными возможностями.

> **Предупреждение**: Следующие сторонние marketplace перечислены только в информационных целях. Caret не поддерживает, не проверяет и не несет ответственности за какие-либо серверы, перечисленные на этих marketplace. Эти серверы являются облачными сервисами, которые обрабатывают ваши запросы и могут иметь доступ к данным, которыми вы с ними делитесь. Всегда изучайте политику конфиденциальности и условия использования перед подключением к сторонним сервисам.

#### Composio MCP Integration

[Composio's MCP Marketplace](https://mcp.composio.dev/) предоставляет доступ к широкому спектру сторонних серверов, поддерживающих Model Context Protocol (MCP). Эти серверы предоставляют API для таких сервисов, как GitHub, Notion, Slack и другие. Каждый сервер включает инструкции по настройке и встроенную поддержку аутентификации (например, OAuth или API keys). Чтобы подключиться, найдите нужный сервис на marketplace и следуйте предоставленным там шагам интеграции.

#### Connecting via Smithery

Smithery - это сторонний MCP server marketplace, который позволяет пользователям находить и подключаться к различным Model Context Protocol (MCP) серверам. Если вы используете MCP-совместимый клиент (такой как Cursor, Claude Desktop или Caret), вы можете просматривать доступные серверы и интегрировать их непосредственно в свой рабочий процесс.

Чтобы изучить доступные варианты, посетите Smithery marketplace: [https://smithery.ai](https://smithery.ai)

Обратите внимание: Smithery поддерживается независимо и не связан с нашим проектом. Используйте на свой страх и риск.

### Управление установленными MCP серверами

После добавления ваши MCP серверы отображаются на вкладке "Configure", где вы можете:

#### View Server Status

Каждый сервер отображает свой текущий статус:

-   **Зеленая точка**: Подключен и готов к использованию
-   **Желтая точка**: В процессе подключения
-   **Красная точка**: Отключен или испытывает ошибки

#### Configure Server Settings

Нажмите на сервер, чтобы развернуть панель его настроек:

1. **Tools & Resources**:
    - Просмотр всех доступных инструментов и ресурсов с сервера
    - Настройка параметров автоматического утверждения для инструментов (если включено)
2. **Request Timeout**:
    - Установите, как долго Caret должен ждать ответа от сервера
    - Диапазон опций от 30 секунд до 1 часа
3. **Server Management**:
    - **Restart Server**: Переподключитесь, если сервер перестает отвечать
    - **Delete Server**: Удалите сервер из вашей конфигурации

#### Enable/Disable Servers

Переключите переключатель рядом с каждым сервером, чтобы включить или выключить его:

-   **Enabled**: Caret может использовать инструменты и ресурсы сервера
-   **Disabled**: Сервер остается в вашей конфигурации, но не активен

### Troubleshooting Connection Issues

Если сервер не подключается:

1. Будет отображено сообщение об ошибке с подробной информацией о сбое
2. **Для ошибок OAuth**: Нажмите кнопку "Authenticate", чтобы завершить процесс авторизации
3. Убедитесь, что URL сервера правильный и сервер работает
4. Попробуйте выбрать другой тип транспорта (Streamable HTTP vs SSE)
5. Используйте кнопку "Restart Server", чтобы попытаться переподключиться
6. Если проблемы не исчезнут, вы можете удалить сервер и попробовать добавить его снова

#### OAuth-Specific Issues

Если у вас возникли проблемы с аутентификацией на сервере с поддержкой OAuth:

-   **"Authentication required" сохраняется**: Убедитесь, что вы завершили процесс авторизации в своем браузере и не отменили его
-   **Браузер не открывается**: Проверьте настройки браузера по умолчанию в вашей системе и убедитесь, что внешние URL можно открывать
-   **Ошибки перенаправления**: Убедитесь, что вы используете последнюю версию Caret - более старые версии могут не поддерживать OAuth
-   **Сброс аутентификации**: Удалите сервер и добавьте его повторно, чтобы начать заново с новым потоком OAuth

### Advanced Configuration

Для опытных пользователей Caret хранит конфигурации MCP серверов в JSON файле, который можно изменять:

1. На вкладке "Configure" нажмите "Configure MCP Servers", чтобы получить доступ к файлу настроек
2. Конфигурация для каждого сервера имеет следующий формат:

```json
{
	"mcpServers": {
		"exampleServer": {
			"url": "https://example.com/mcp-server",
			"type": "streamableHttp",
			"disabled": false,
			"autoApprove": ["tool1", "tool2"],
			"timeout": 60
		}
	}
}
```

Основные параметры конфигурации:

-   **url**: URL endpoint (для удаленных серверов)
-   **type**: Транспортный протокол - `"streamableHttp"` (рекомендуется) или `"sse"` (устаревший)
-   **disabled**: Указывает, включен ли сервер в данный момент (true/false)
-   **autoApprove**: Список названий инструментов, не требующих подтверждения
-   **timeout**: Максимальное время в секундах ожидания ответа от сервера (по умолчанию: 60)

Для дополнительных настроек MCP щелкните ссылку "Advanced MCP Settings", чтобы получить доступ к настройкам VSCode.

### Using MCP Server Tools

После подключения Caret может использовать инструменты и ресурсы, предоставляемые MCP сервером. Когда Caret предлагает использовать MCP tool:

1. Появится запрос на утверждение tool (если не утвержден автоматически)
2. Просмотрите сведения об инструменте и параметры перед утверждением
3. Инструмент будет выполнен и вернет результаты в Caret

### Example: Connecting to Vercel MCP

[Vercel MCP](https://vercel.com/docs/mcp/vercel-mcp) - это сервер с поддержкой OAuth, который предоставляет инструменты для управления вашими Vercel проектами и развертываниями:

1. Перейдите на вкладку "Remote Servers"
2. Введите:
    - **Server Name**: `vercel`
    - **Server URL**: `https://mcp.vercel.com`
    - **Transport Type**: Streamable HTTP (выбран по умолчанию)
3. Нажмите "Add Server"
4. Вы увидите "Authentication required" - нажмите кнопку **"Authenticate"**
5. Войдите в Vercel в своем браузере и авторизуйте Caret
6. Вернитесь в Caret - сервер подключится автоматически
7. Инструменты Vercel (deploy, logs, projects) теперь доступны для Caret!

Ваша аутентификация Vercel сохраняется между сеансами, поэтому вам не нужно будет повторно проходить аутентификацию каждый раз при использовании Caret.
