---
title: "连接到远程服务器"
description: "模型上下文协议（MCP）允许 Caret 与提供附加工具和资源以扩展其能力的外部服务器通信。本指南说明如何通过 MCP 服务器界面添加和连接到远程 MCP 服务器。"
---

## 添加和管理远程 MCP 服务器

### 访问 MCP 服务器界面

要在 Caret 中访问 MCP 服务器界面：

1. 单击 VSCode 侧边栏中的 Caret 图标
2. 打开 Caret 面板右上角的菜单（⋮）
3. 从下拉菜单中选择"MCP 服务器"

### 了解 MCP 服务器界面

MCP 服务器界面分为三个主要选项卡：

-   **市场**：发现和安装预配置的 MCP 服务器（如果启用）
-   **远程服务器**：通过 URL 端点连接到现有的 MCP 服务器
-   **已安装**：管理您连接的 MCP 服务器

### 添加远程 MCP 服务器

"远程服务器"选项卡允许您连接到任何可通过 URL 端点访问的 MCP 服务器：

1. 单击 MCP 服务器界面中的"远程服务器"选项卡
2. 填写所需信息：
    - **服务器名称**：为服务器提供唯一的描述性名称
    - **服务器 URL**：输入 MCP 服务器的完整 URL 端点（例如，`https://example.com/mcp-sse`）
3. 单击"添加服务器"以启动连接
4. Caret 将尝试连接到服务器并显示连接状态

> **注意**：连接到远程服务器时，请确保您信任来源，因为 MCP 服务器可以在您的环境中执行代码。

### 远程服务器发现

如果您正在寻找要连接的 MCP 服务器，几个第三方市场提供具有各种功能的可用服务器目录。

> **警告**：以下第三方市场仅供参考。Caret 不认可、验证或对这些市场上列出的任何服务器负责。这些服务器是处理您的请求并可能访问您与它们共享的数据的云托管服务。在连接到第三方服务之前，请务必查看隐私政策和使用条款。

#### Composio MCP 集成

[Composio 的 MCP 市场](https://mcp.composio.dev/)提供对支持模型上下文协议（MCP）的各种第三方服务器的访问。这些服务器公开了 GitHub、Notion、Slack 等服务的 API。每个服务器都包含配置说明和内置身份验证支持（例如 OAuth 或 API 密钥）。要连接，请在市场中找到所需的服务，并按照那里提供的集成步骤操作。

#### 通过 Smithery 连接

Smithery 是一个第三方 MCP 服务器市场，允许用户发现并连接到各种模型上下文协议（MCP）服务器。如果您使用兼容 MCP 的客户端（如 Cursor、Claude Desktop 或 Caret），您可以浏览可用的服务器并将它们直接集成到您的工作流程中。

要探索可用选项，请访问 Smithery 市场：[https://smithery.ai](https://smithery.ai)

请注意：Smithery 是独立维护的，与我们的项目无关。使用风险自负。

### 管理已安装的 MCP 服务器

添加后，您的 MCP 服务器将显示在"已安装"选项卡中，您可以在其中：

#### 查看服务器状态

每个服务器显示其当前状态：

-   **绿点**：已连接并准备使用
-   **黄点**：正在连接过程中
-   **红点**：已断开连接或遇到错误

#### 配置服务器设置

单击服务器以展开其设置面板：

1. **工具和资源**：
    - 查看服务器的所有可用工具和资源
    - 配置工具的自动批准设置（如果启用）
2. **请求超时**：
    - 设置 Caret 应等待服务器响应的时间
    - 选项范围从 30 秒到 1 小时
3. **服务器管理**：
    - **重新启动服务器**：如果服务器无响应，重新连接
    - **删除服务器**：从配置中删除服务器

#### 启用/禁用服务器

切换每个服务器旁边的开关以启用或禁用它：

-   **已启用**：Caret 可以使用服务器的工具和资源
-   **已禁用**：服务器保留在您的配置中但未激活

### 排除连接问题

如果服务器无法连接：

1. 将显示错误消息，其中包含有关失败的详细信息
2. 检查服务器 URL 是否正确且服务器正在运行
3. 使用"重新启动服务器"按钮尝试重新连接
4. 如果问题持续存在，您可以删除服务器并尝试重新添加

### 高级配置

对于高级用户，Caret 将 MCP 服务器配置存储在可以修改的 JSON 文件中：

1. 在"已安装"选项卡中，单击"配置 MCP 服务器"以访问设置文件
2. 每个服务器的配置遵循以下格式：

```json
{
	"mcpServers": {
		"exampleServer": {
			"url": "https://example.com/mcp-sse",
			"disabled": false,
			"autoApprove": ["tool1", "tool2"],
			"timeout": 30
		}
	}
}
```

关键配置选项：

-   **url**：端点 URL（对于远程服务器）
-   **disabled**：服务器当前是否启用（true/false）
-   **autoApprove**：不需要确认的工具名称列表
-   **timeout**：等待服务器响应的最长时间（秒）

有关其他 MCP 设置，请单击"高级 MCP 设置"链接以访问 VSCode 设置。

### 使用 MCP 服务器工具

连接后，Caret 可以使用 MCP 服务器提供的工具和资源。当 Caret 建议使用 MCP 工具时：

1. 将出现工具批准提示（除非自动批准）
2. 在批准之前查看工具详细信息和参数
3. 工具将执行并将结果返回给 Caret
