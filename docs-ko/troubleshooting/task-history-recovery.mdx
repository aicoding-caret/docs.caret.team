---
title: "작업 기록 복구 가이드"
sidebarTitle: "작업 기록 복구"
description: "Caret 작업 기록을 복구하고 재구성하는 방법"
---

Caret 업데이트나 설정 변경 후 이전 작업이 보이지 않는 경우가 있습니다. 이 가이드는 작업 기록을 복구하고, 중요한 대화를 다시 가져오는 방법을 안내합니다.

<Tip>
대부분의 경우 내장 복구 명령을 실행하면 해결됩니다.
</Tip>

## 빠른 복구

<Steps>
	<Step title="명령 팔레트 열기">
		`Cmd/Ctrl + Shift + P`로 명령 팔레트를 엽니다.
	</Step>
	<Step title="복구 명령 실행">
		**"Caret: Reconstruct Task History"**를 입력하고 선택합니다.
	</Step>
	<Step title="확인">
		확인 팝업이 뜨면 **Yes**를 클릭합니다.
	</Step>
	<Step title="재구성 대기">
		Caret이 작업 폴더를 스캔해 기록 인덱스를 재구성합니다.
	</Step>
	<Step title="복구 확인">
		기록 패널에서 작업이 복구됐는지 확인합니다.
	</Step>
</Steps>

## Caret 데이터 저장 위치

### 저장 경로

<Tabs>
	<TabItem value="vs-code" title="VS Code">
		```bash
		# macOS
		~/Library/Application Support/Code/User/globalStorage/caretive.caret/
		# Windows
		%APPDATA%\Code\User\globalStorage\caretive.caret\
		# Linux
		~/.config/Code/User/globalStorage/caretive.caret/
		```
	</TabItem>
	<TabItem value="jetbrains" title="JetBrains">
		```bash
		# macOS
		~/Library/Application Support/JetBrains/<IDE>/globalStorage/caretive.caret/
		# Windows
		%APPDATA%\JetBrains\<IDE>\globalStorage\caretive.caret\
		# Linux
		~/.config/JetBrains/<IDE>/globalStorage/caretive.caret/
		```
	</TabItem>
</Tabs>

VS Code Insiders는 `Code` 대신 `Code - Insiders`를 사용합니다. JetBrains는 `<IDE>`를 실제 제품명(예: `IntelliJIdea2023.3`, `PyCharm2023.3`)으로 바꾸세요.

### 디렉터리 구조

```
caretive.caret/
├── state/
│   ├── taskHistory.json          # 메인 기록 인덱스
│   └── taskHistory.backup.*.json # 백업
├── tasks/
│   └── <task-id>/                # 개별 작업 데이터
│       ├── api_conversation_history.json
│       ├── ui_messages.json
│       └── task_metadata.json
└── checkpoints/
    └── <workspace-hash>/         # 워크스페이스별 체크포인트
        └── .git/                 # 스냅샷용 Git 저장소
```

`taskHistory.json`은 인덱스일 뿐이며, 실제 대화 데이터는 `tasks/` 폴더에 저장됩니다.

## 복구 명령 동작 방식

복구 명령은 모든 작업 폴더를 스캔해 기록 인덱스를 새로 만듭니다.

동작 과정:

1. 기존 `taskHistory.json` 백업
2. `tasks/` 폴더 스캔
3. 각 작업 폴더에서 대화 데이터 읽기
4. 토큰/비용 재계산
5. 새로운 `taskHistory.json` 생성

```mermaid
graph LR
    A[Backup current] --> B[Scan tasks/]
    B --> C[Read each task]
    C --> D[Rebuild index]
    D --> E[Done]
```

<Warning>
복구는 **기존 작업 폴더를 기반**으로 이루어집니다. `tasks/` 폴더나 작업 폴더가 삭제되었다면 해당 데이터는 복구할 수 없습니다.
</Warning>

## 수동 복구

### 백업에서 복원

Caret은 자동으로 백업을 만듭니다. `state/` 폴더에서 확인하세요:

<Tabs>
	<TabItem value="vs-code" title="VS Code">
		```bash
		# macOS/Linux
		cd ~/.config/Code/User/globalStorage/caretive.caret/state/
		ls taskHistory.backup.*.json

		# 가장 최신 파일로 복원
		cp taskHistory.backup.1234567890.json taskHistory.json
		```
	</TabItem>
	<TabItem value="jetbrains" title="JetBrains">
		```bash
		# macOS
		cd ~/Library/Application\ Support/JetBrains/<IDE>/globalStorage/caretive.caret/state/
		ls taskHistory.backup.*.json

		# 가장 최신 파일로 복원
		cp taskHistory.backup.1234567890.json taskHistory.json
		```
	</TabItem>
</Tabs>

### 새 머신으로 이동

새 컴퓨터로 옮길 때는 아래 절차를 따르면 됩니다:

<Steps>
	<Step title="기존 데이터 복사">
		**기존 머신**에서 위 경로의 `caretive.caret` 폴더를 통째로 복사합니다.
	</Step>
	<Step title="새 머신 준비">
		**새 머신**에 VS Code 또는 JetBrains IDE와 Caret 확장을 설치합니다.
	</Step>
	<Step title="IDE 종료">
		복사 전에 IDE를 완전히 종료하세요.
	</Step>
	<Step title="데이터 붙여넣기">
		동일한 경로에 `caretive.caret` 폴더를 붙여넣습니다.
	</Step>
	<Step title="실행 및 확인">
		IDE를 다시 열어 기록이 복구됐는지 확인합니다.
	</Step>
</Steps>

<Info>
데이터 포맷은 OS 간 동일하므로, Windows ↔ macOS 간 이동도 추가 작업 없이 가능합니다.
</Info>

## 자주 발생하는 문제

### VS Code 업데이트 후 기록이 비어 있음
명령 팔레트에서 **"Caret: Reconstruct Task History"**를 실행하세요. 그래도 안 되면 백업 파일을 복원해보세요.

### VS Code 재설치 후 기록이 사라짐
VS Code는 보통 확장 데이터를 유지합니다. Caret 재설치 후 복구 명령을 실행하세요.

### "No tasks found" 오류
`tasks/` 폴더가 비어 있거나 사라진 경우입니다.

- VS Code 데이터가 완전히 삭제됨
- 잘못된 설치(표준 vs Insiders) 경로 확인 필요
- 폴더가 수동 삭제됨

올바른 경로를 다시 확인하세요.

### 복구는 되었지만 일부 작업이 없음
손상된 작업 폴더는 복구 중 스킵됩니다. 복구 결과에서 스킵 수와 오류를 확인하세요.

## 추가 도움이 필요할 때

1. **GitHub 이슈 등록**: [aicoding-caret/caret](https://github.com/aicoding-caret/caret/issues)
2. **Discord 문의**: [Caret Discord](https://discord.gg/caret)

이슈 보고 시 포함하면 좋은 정보:

- OS와 IDE 버전
- Caret 버전
- 데이터 손실 전 수행한 작업
- 오류 메시지
- **작업 데이터**: 영향을 받은 작업 폴더의 JSON 파일(`api_conversation_history.json`, `ui_messages.json`, `task_metadata.json`)
