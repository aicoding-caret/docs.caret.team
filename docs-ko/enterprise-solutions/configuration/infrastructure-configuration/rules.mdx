---
title: "Rules"
sidebarTitle: "Rules"
description: "엔터프라이즈 배포에서 Caret의 동작을 정의하는 커스텀 지침 파일"
---

Rules는 **코딩 선호도, 표준, 모범 사례**를 Caret에 전달하는 커스텀 지침 파일입니다. 작업 중 Caret의 컨텍스트에 자동으로 포함됩니다.

## Rules란?

Rules는 `.agents/context/` 디렉토리에 저장되는 간단한 Markdown 파일입니다. 다음을 Caret에 알려줍니다.

- 코드 스타일과 컨벤션
- 선호 라이브러리/프레임워크
- 아키텍처 패턴
- 테스트 전략
- 문서화 표준
- 커뮤니케이션 방식

<Tip>
Rules는 단순한 `.md` 파일입니다. 복잡한 설정이 필요하지 않습니다.
</Tip>

## 간단 예시

TypeScript 규칙 예시:

```markdown
# TypeScript 컨벤션

## 코드 스타일
- 2칸 들여쓰기 사용
- `let`보다 `const` 우선
- 함수는 명시적 반환 타입 사용
- default export 대신 named export 사용

## 테스트
- 유틸 함수에 유닛 테스트 작성
- Vitest 사용
- 신규 코드 커버리지 80% 이상

## 의존성
- TypeScript 내장 기능 우선
- 런타임 검증에 Zod 사용
- 날짜 처리에 date-fns 사용
```

## Rules 만들기

<Tabs>
  <Tab title="/newrule 사용">
    `/newrule` 명령으로 쉽게 생성할 수 있습니다.
    
    1. 대화 중 `/newrule` 입력
    2. Caret가 대화를 분석해 규칙 파일 생성
    3. `.agents/context/`에 Markdown 파일 생성
    
    **예시:**
    ```
    /newrule
    
    React 컴포넌트 구조 규칙을 만들어줘
    ```
  </Tab>
  
  <Tab title="수동 생성">
    직접 파일을 만들어도 됩니다.
    
    1. 저장소 루트에 `.agents/context/` 생성
    2. Markdown 파일로 규칙 작성
    3. `react-patterns.md`, `api-conventions.md` 같은 이름 사용
    
    **예시 구조:**
    ```
    your-repo/
    ├── .agents/context/
    │   ├── typescript-style.md
    │   ├── testing-standards.md
    │   └── code-review-checklist.md
    └── src/
    ```
  </Tab>
</Tabs>

## 전역 규칙 vs 워크스페이스 규칙

<CardGroup cols={2}>
  <Card title="워크스페이스 규칙" icon="folder">
    **위치:** 프로젝트 루트의 `.agents/context/`
    
    **범위:** 해당 프로젝트에만 적용
    
    **용도:** 프로젝트별 규칙/패턴
  </Card>
  
  <Card title="전역 규칙" icon="globe">
    **위치:** `Documents/Caret/Rules/`
    
    **범위:** 모든 프로젝트
    
    **용도:** 개인 공통 규칙
  </Card>
</CardGroup>

## 규칙 관리

### 규칙 토글

개별 규칙 파일을 켜거나 끌 수 있습니다.

1. Caret UI의 규칙 아이콘 클릭
2. 규칙 목록에서 토글
3. 변경 사항은 새 작업부터 적용

<Note>
규칙을 끄면 컨텍스트에서 제외될 뿐 파일은 유지됩니다. 언제든 다시 켤 수 있습니다.
</Note>

### 엔터프라이즈 원격 규칙

<Info>
엔터프라이즈 배포는 **원격 전역 규칙**을 모든 구성원에게 강제할 수 있습니다. 이 규칙은 인프라 구성으로 관리되며 사용자 개인이 끌 수 없습니다.
</Info>

**예시 구성**
```json
{
  "globalRules": [
    {
      "name": "security-policy.md",
      "alwaysEnabled": true,
      "contents": "# 보안 정책\n- 민감 정보는 로그에 남기지 않기"
    }
  ]
}
```

## 호환 규칙 형식

Caret는 다른 도구의 규칙도 인식합니다.

| 파일/디렉토리 | 도구 | 위치 |
|----------------|------|----------|
| `.cursorrules` | Cursor | 워크스페이스 루트(단일 파일) |
| `.cursor/rules/` | Cursor | 워크스페이스 디렉토리(`.mdc` 파일) |
| `.windsurfrules` | Windsurf | 워크스페이스 루트(단일 파일) |
| `AGENTS.md` | Various | 워크스페이스 루트 + 재귀 검색 |

<Note>
**AGENTS.md 동작:** 워크스페이스 루트에 `AGENTS.md`가 있을 때만 하위 디렉토리의 `AGENTS.md`를 재귀적으로 탐색합니다. 발견된 모든 `AGENTS.md`는 상대 경로를 헤더로 합쳐 사용됩니다.
</Note>

이 파일들은 `.agents/context/` 규칙과 동일하게 토글할 수 있습니다.

## 모범 사례

<AccordionGroup>
  <Accordion title="규칙은 한 주제에 집중" icon="bullseye">
    - ✅ `typescript-conventions.md`
    - ✅ `react-component-structure.md`
    - ❌ `everything-about-our-codebase.md`
  </Accordion>
  
  <Accordion title="구체적으로 작성" icon="crosshairs">
    - ✅ "서버 상태는 React Query 사용"
    - ❌ "상태 관리는 모범 사례를 따르세요"
  </Accordion>
  
  <Accordion title="프로젝트 변화에 맞춰 업데이트" icon="rotate">
    - 새 기술 도입
    - 아키텍처 변경
    - 팀 컨벤션 변경
  </Accordion>
  
  <Accordion title="규칙 과다 방지" icon="gauge-simple-high">
    - 3~5개 핵심 규칙부터 시작
    - 필요할 때만 추가
    - 오래된 규칙은 정리
  </Accordion>
</AccordionGroup>

## 예시 규칙

<AccordionGroup>
  <Accordion title="API 설계 표준" icon="code">
```markdown
# API 설계 표준

## REST 규칙
- 엔드포인트는 복수 명사 사용(`/users`)
- HTTP 메서드 의미 준수(GET/POST/PUT/DELETE)
- 적절한 상태 코드 반환

## 응답 형식
```typescript
{
  data: T,
  error?: string,
  metadata?: {
    page: number,
    total: number
  }
}
```

## 에러 처리
- `error` 필드에 메시지 포함
- 4xx는 클라이언트, 5xx는 서버 오류
- 요청 ID 포함
```
  </Accordion>
  
  <Accordion title="테스트 요구 사항" icon="vial">
```markdown
# 테스트 요구 사항

## 테스트 구성
- 소스 파일 옆에 테스트 배치(`Button.test.tsx`)
- `describe`로 관련 테스트 그룹화
- 설명적인 테스트 이름 사용

## 커버리지
- 유틸 함수 유닛 테스트 필수
- API 엔드포인트 통합 테스트
- 주요 사용자 흐름 E2E 테스트
- 신규 코드 80% 커버리지

## Mock 전략
- 외부 API 호출은 Mock 처리
- 복잡 데이터는 테스트 픽스처 사용
- DI로 테스트 용이성 확보
```
  </Accordion>
</AccordionGroup>

## 다음 단계

<CardGroup cols={2}>
  <Card title="Workflows" icon="diagram-project" href="/enterprise-solutions/configuration/infrastructure-configuration/workflows">
    규칙과 워크플로 조합하기
  </Card>
  
  <Card title="원격 구성" icon="cloud" href="/enterprise-solutions/configuration/remote-configuration/overview">
    팀에 전역 규칙 배포
  </Card>
</CardGroup>
