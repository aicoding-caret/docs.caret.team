---
title: "API Key (Configuration simple)"
sidebarTitle: "API Key"
description: "Configurez AWS Bedrock avec Caret en utilisant les API Keys Bedrock. La configuration la plus simple pour permettre aux développeurs individuels d'accéder aux frontier models."
---

### Overview

-   **AWS Bedrock :** Un service entièrement géré qui offre un accès aux modèles d'IA générative de pointe (par exemple, Anthropic Claude, Amazon Nova) via AWS.\
    [En savoir plus sur AWS Bedrock](https://docs.aws.amazon.com/bedrock/latest/userguide/what-is-bedrock.html).
-   **Caret :** Une extension VS Code qui agit comme un assistant de codage en s'intégrant aux modèles d'IA, permettant aux développeurs de générer du code, de débugger et d'analyser des données.
-   **Focus Développeur :** Ce guide est conçu pour les développeurs individuels qui souhaitent activer l'accès aux frontier models via AWS Bedrock avec une configuration simplifiée utilisant des API Keys.

---

### Step 1: Préparer votre environnement AWS

#### 1.1 Configuration pour utilisateur individuel - Créer une API Key Bedrock

Pour des instructions plus détaillées, consultez la [documentation](https://docs.aws.amazon.com/bedrock/latest/userguide/api-keys.html).

1. **Connectez-vous à la AWS Management Console :**\
   [AWS Console](https://aws.amazon.com/console/)
2. **Accédez à la console Bedrock :**
    - [Bedrock Console](https://console.aws.amazon.com/bedrock)
    - Créez une nouvelle Long Lived API Key. Cette API Key aura par défaut la politique IAM `AmazonBedrockLimitedAccess`
      [Voir les détails de la politique AmazonBedrockLimitedAccess](https://docs.aws.amazon.com/bedrock/latest/userguide/security-iam.html)

#### 1.2 Créer ou modifier la politique

Pour garantir que Caret peut interagir avec AWS Bedrock, votre utilisateur ou rôle IAM a besoin de permissions spécifiques. Bien que la politique gérée `AmazonBedrockLimitedAccess` fournisse un accès complet, pour une configuration plus restreinte et sécurisée respectant le principe du moindre privilège, les permissions minimales suivantes sont suffisantes pour la fonctionnalité principale d'invocation de modèle de Caret :

-   `bedrock:InvokeModel`
-   `bedrock:InvokeModelWithResponseStream`
-   `bedrock:CallWithBearerToken`

Vous pouvez créer une politique IAM personnalisée avec ces permissions et l'attacher à votre utilisateur ou rôle IAM.

1.  Dans la console AWS IAM, créez une nouvelle politique.
2.  Utilisez l'éditeur JSON pour ajouter le document de politique suivant :
    ```json
    {
    	"Version": "2012-10-17",
    	"Statement": [
    		{
    			"Effect": "Allow",
    			"Action": ["bedrock:InvokeModel", "bedrock:InvokeModelWithResponseStream", "bedrock:CallWithBearerToken"],
    			"Resource": "*" // Pour une sécurité renforcée, limitez la portée aux ARN de modèles spécifiques si possible.
    		}
    	]
    }
    ```
3.  Nommez la politique (par exemple, `ClineBedrockInvokeAccess`) et attachez-la à l'utilisateur IAM associé à la clé que vous avez créée. L'utilisateur IAM et l'API Key ont le même préfixe.

**Considérations importantes :**

-   **Liste des modèles dans Caret :** Les permissions minimales (`bedrock:InvokeModel`, `bedrock:InvokeModelWithResponseStream`) sont suffisantes pour que Caret puisse *utiliser* un modèle si vous spécifiez l'ID du modèle directement dans les paramètres de Caret. Si vous comptez sur Caret pour lister dynamiquement les modèles Bedrock disponibles, vous pourriez avoir besoin de permissions supplémentaires comme `bedrock:ListFoundationModels`.
-   **Abonnements AWS Marketplace :** Pour les modèles tiers (par exemple, Anthropic Claude), la politique **`AmazonBedrockLimitedAccess`** vous accorde les permissions nécessaires pour vous abonner via le AWS Marketplace. Il n'y a pas d'accès explicite à activer. Pour les modèles Anthropic, vous devez toujours soumettre un formulaire de première utilisation (FTU) via la Console. Si vous recevez le message suivant dans le chat Caret `[ERROR] Failed to process response: Model use case details have not been submitted for this account. Fill out the Anthropic use case details form before using the model.`, ouvrez alors le [Playground dans la console AWS Bedrock](https://console.aws.amazon.com/bedrock/home?#/text-generation-playground), sélectionnez n'importe quel modèle Anthropic et remplissez le formulaire (vous devrez peut-être envoyer un prompt au préalable).

---

### Step 2: Vérifier l'accès régional et aux modèles

#### 2.1 Choisir et confirmer une région

1. **Sélectionnez une région :**\
   AWS Bedrock est disponible dans plusieurs régions (par exemple, US East, Europe, Asia Pacific). Choisissez la région qui répond à vos besoins de latence et de conformité.\
   [AWS Global Infrastructure](https://aws.amazon.com/about-aws/global-infrastructure/regions_az/)
2. **Vérifier l'accès au modèle :**
    - **Note :** Certains modèles ne sont accessibles que via un [Inference Profile](https://docs.aws.amazon.com/bedrock/latest/userguide/inference-profiles-support.html). Dans ce cas, cochez la case "Cross Region Inference".

---

### Step 3: Configurer l'extension VS Code Caret

#### 3.1 Installer et ouvrir Caret

1. **Installer VS Code :**\
   Téléchargez-le depuis le [site web de VS Code](https://code.visualstudio.com/).
2. **Installer l'extension Caret :**
    - Ouvrez VS Code.
    - Allez dans l'Extensions Marketplace (`Ctrl+Shift+X` ou `Cmd+Shift+X`).
    - Recherchez **Caret** et installez-le.

#### 3.2 Configurer les paramètres de Caret

1. **Ouvrir les paramètres de Caret :**
    - Cliquez sur les paramètres ⚙️ pour sélectionner votre API Provider.
2. **Sélectionner AWS Bedrock comme API Provider :**
    - Dans le menu déroulant API Provider, choisissez **AWS Bedrock**.
3. **Saisir votre AWS API Key :**
    - Entrez votre **API Key**
    - Spécifiez la bonne **AWS Region** (par exemple, `us-east-1` ou votre région approuvée par l'entreprise).
4. **Sélectionner un modèle :**
    - Choisissez un modèle on-demand (par exemple, **anthropic.claude-3-5-sonnet-20241022-v2:0**).
5. **Enregistrer et tester :**
    - Cliquez sur **Done/Save** pour appliquer vos paramètres.
    - Testez l'intégration en envoyant un prompt simple (par exemple, "Générer une fonction Python pour vérifier si un nombre est premier.").

---

### Step 4: Sécurité, surveillance et bonnes pratiques

1. **Accès sécurisé :**
    - Préférez AWS SSO/rôles fédérés aux API Key de longue durée lorsque cela est possible.
    - [Bonnes pratiques AWS IAM](https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html)
2. **Renforcer la sécurité réseau :**
    - Envisagez de configurer [AWS PrivateLink](https://docs.aws.amazon.com/vpc/latest/userguide/endpoint-services-overview.html) pour vous connecter à Bedrock de manière sécurisée.
3. **Surveiller et journaliser l'activité :**
    - Activez AWS CloudTrail pour journaliser les appels API Bedrock.
    - Utilisez CloudWatch pour surveiller les métriques telles que le nombre d'invocations, la latence et l'utilisation des tokens.
    - Configurez des alertes pour toute activité anormale.
4. **Gérer les erreurs et les coûts :**
    - Implémentez un exponential backoff pour les erreurs de limitation (throttling).
    - Utilisez AWS Cost Explorer et configurez des alertes de facturation pour suivre l'utilisation.\
      [AWS Cost Management](https://docs.aws.amazon.com/cost-management/latest/userguide/what-is-aws-cost-management.html)
5. **Audits réguliers et conformité :**
    - Examinez périodiquement les rôles IAM et les journaux CloudTrail.
    - Respectez les politiques internes de gouvernance et de confidentialité des données.

---

### Conclusion

En suivant ces étapes, vous pouvez rapidement intégrer AWS Bedrock avec l'extension VS Code Caret pour accélérer votre développement :

1. **Préparez votre environnement AWS :** Créez une API Key Bedrock avec les permissions nécessaires.
2. **Vérifiez l'accès à la région et au modèle :** Confirmez que votre région sélectionnée prend en charge les modèles requis.
3. **Configurez Caret dans VS Code :** Installez et configurez Caret avec votre AWS API Key et choisissez un modèle approprié.
4. **Implémentez la sécurité et la surveillance :** Utilisez les meilleures pratiques pour IAM, la sécurité réseau, la surveillance et la gestion des coûts.

Pour plus de détails, consultez la [documentation AWS Bedrock](https://docs.aws.amazon.com/bedrock/latest/userguide/what-is-bedrock.html). Bon codage !

---

_Ce guide sera mis à jour au fur et à mesure de l'évolution de AWS Bedrock et de Caret. Référez-vous toujours à la documentation la plus récente et aux politiques internes pour les pratiques à jour._